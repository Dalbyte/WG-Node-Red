[{"id":"8634e68f.33d288","type":"tab","label":"TelegramDrucker","disabled":false,"info":""},{"id":"57564e10.76e3a","type":"tab","label":"TelegramTastaturBeispiel","disabled":false,"info":""},{"id":"e42fce10.df527","type":"subflow","name":"Telegram Tastatur","info":"","category":"","in":[{"x":400,"y":220,"wires":[{"id":"b6a36b1c.929778"}]}],"out":[{"x":780,"y":220,"wires":[{"id":"b6a36b1c.929778","port":0}]}],"env":[{"name":"Nachricht","type":"str","value":"","ui":{"icon":"font-awesome/fa-bullhorn","label":{},"type":"input","opts":{"types":["str","num","bool","json","bin","env"]}}},{"name":"Optionen","type":"str","value":""}],"color":"#3FADB5","icon":"font-awesome/fa-bars"},{"id":"25552ba1.aec3a4","type":"subflow","name":"Telegram Tastatur Response Block","info":"","category":"","in":[{"x":40,"y":80,"wires":[{"id":"d3e84e8e.13873"}]}],"out":[{"x":360,"y":80,"wires":[{"id":"d3e84e8e.13873","port":0}]}],"env":[],"color":"#3FADB5","icon":"font-awesome/fa-close"},{"id":"e892f35.0c4c61","type":"subflow","name":"inline keyboard message","info":"# Inline Keyboard Nachrichten\n\n## Input\n\n### Optionen\n\n``Taste01,Taste02,Taste03``\n\n**Achtung**\n\n> Komma Trennung muss stimmen.\n\n> Komma ist Array Trennungsmarker\n\n### Nachricht\n``Ich bin die Frage/Erklärung wofür die Buttons stehen``\n\n**Achtung**\n\n> Kurz Kompakt halten\n\n### OptionStatic\n\nmsg.OptionDynamic\n","category":"","in":[{"x":220,"y":240,"wires":[{"id":"7600fac2.559b24"}]}],"out":[{"x":1020,"y":240,"wires":[{"id":"69d0326a.ff4b3c","port":0}]}],"env":[{"name":"Optionen","type":"str","value":""},{"name":"Nachricht","type":"str","value":""},{"name":"OptionDynamic","type":"bool","value":"true"},{"name":"SingleOrArraySpam","type":"bool","value":"true"}],"color":"#DDAA99"},{"id":"2473102b.7ad87","type":"subflow","name":"Nachricht","info":"","category":"","in":[{"x":280,"y":220,"wires":[{"id":"1fcc79c9.cf4316"}]}],"out":[{"x":840,"y":220,"wires":[{"id":"1fcc79c9.cf4316","port":0}]}],"env":[{"name":"type","type":"str","value":"","ui":{"icon":"font-awesome/fa-bullhorn","label":{"en-US":"Nachrichten Optionen"},"type":"select","opts":{"opts":[{"l":{"en-US":"message"},"v":"message"},{"l":{"en-US":"audio"},"v":"audio"},{"l":{"en-US":"video"},"v":"video"},{"l":{"en-US":"video_note"},"v":"video_note"},{"l":{"en-US":"sticker"},"v":"sticker"},{"l":{"en-US":"animation"},"v":"animation"},{"l":{"en-US":"voice"},"v":"voice"},{"l":{"en-US":"document"},"v":"document"},{"l":{"en-US":"location"},"v":"location"},{"l":{"en-US":"contact"},"v":"contact"},{"l":{"en-US":"venue"},"v":"venue"},{"l":{"en-US":"mediaGroup"},"v":"mediaGroup"},{"l":{"en-US":"photo"},"v":"photo"}]}}},{"name":"chatId","type":"num","value":""},{"name":"content","type":"str","value":""},{"name":"InputContentToggle","type":"bool","value":"true"},{"name":"specificchatId","type":"bool","value":"false"}],"color":"#DDAA99"},{"id":"fcbed297.e969b","type":"subflow","name":"WG-User-Blocker","info":"","category":"","in":[{"x":60,"y":80,"wires":[{"id":"8a0a416e.477ef"}]}],"out":[{"x":340,"y":80,"wires":[{"id":"8a0a416e.477ef","port":0},{"id":"8a0a416e.477ef","port":1},{"id":"8a0a416e.477ef","port":2}]}],"env":[],"color":"#DDAA99"},{"id":"31b2379a.04d2d8","type":"telegram bot","z":"","botname":"PrinterBeesemaise_Bot","usernames":"","chatids":"-459335104,259572712,213321950","baseapiurl":"","updatemode":"polling","pollinterval":"3000","usesocks":false,"sockshost":"","socksport":"6667","socksusername":"anonymous","sockspassword":"","bothost":"","localbotport":"8443","publicbotport":"8443","privatekey":"","certificate":"","useselfsignedcertificate":false,"sslterminated":false,"verboselogging":false},{"id":"d3e84e8e.13873","type":"function","z":"25552ba1.aec3a4","name":"create response","func":"if(context.global.keyboard.pending)\n{\n    context.global.keyboard.pending = false;\n    return msg;\n}","outputs":1,"noerr":0,"x":200,"y":80,"wires":[[]]},{"id":"b6a36b1c.929778","type":"function","z":"e42fce10.df527","name":"confirmation message","func":"context.global.keyboard = { pending : true};\n\nlet optionen = env.get(\"Optionen\").split(\",\");\nlet length = optionen.length;\nlet tasten = \"\";\n\nlet i;\nfor (i = 0; i < optionen.length; i++) {\n  tasten = tasten + '[\"' + optionen[i] + '\"],';\n}\ntasten = tasten.slice(0, -1);\n\nlet key = '{\"keyboard\": ['+tasten+'],\"resize_keyboard\" : true,\"one_time_keyboard\" : true}';\n\nvar opts = {\n    reply_to_message_id: msg.payload.messageId,\n    reply_markup: key\n};\n\nmsg.payload.content = env.get(\"Nachricht\");\nmsg.payload.options = opts;\n\nreturn [msg];","outputs":1,"noerr":0,"x":600,"y":220,"wires":[[]]},{"id":"3bf10ab6.d7d2b6","type":"telegram command","z":"8634e68f.33d288","name":"","command":"/jpg","bot":"31b2379a.04d2d8","strict":false,"x":130,"y":240,"wires":[["ffd59670.4d0428"],[]]},{"id":"8823acf4.a621b","type":"telegram sender","z":"8634e68f.33d288","name":"","bot":"31b2379a.04d2d8","x":1450,"y":280,"wires":[[]]},{"id":"f1e9ea10.69f1e8","type":"subflow:e892f35.0c4c61","z":"8634e68f.33d288","name":"","env":[{"name":"Optionen","value":"test01,test02,test03","type":"str"},{"name":"Nachricht","value":"Welche Datei willst du haben.","type":"str"},{"name":"OptionToggle","value":"false","type":"bool"}],"x":1230,"y":280,"wires":[["8823acf4.a621b"]]},{"id":"1fcc79c9.cf4316","type":"function","z":"2473102b.7ad87","name":"Nachricht","func":"let message = new Object();\n\nif(env.get(\"specificchatId\")){\n    message.chatId = env.get(\"chatId\");\n}else{\n    message.chatId = msg.payload.chatId;\n}\n\nmessage.type = env.get(\"type\");\nmessage.content = env.get(\"content\");\n\n// Togglet Input ob man Content in Flow oder Über den Node mit gibt.\nif(env.get(\"InputContentToggle\")){\n    message.content = env.get(\"content\");\n}else{\n    message.content = msg.customcontent;\n}\n\n// Output Final\nmsg.payload = message\n\n// msg.payload = '{ \"chatId\" : \"' + env.get(\"chatId\") + '\", \"type\" : \"' + env.get(\"type\") + '\", \"content\" : \"' + env.get(\"content\") + '\"}';\nreturn msg;","outputs":1,"noerr":0,"x":500,"y":220,"wires":[[]]},{"id":"5f9837f1.92b958","type":"fs-ops-dir","z":"8634e68f.33d288","name":"","path":"path","pathType":"msg","filter":".jpg","filterType":"str","dir":"files","dirType":"msg","x":620,"y":240,"wires":[["7b714822.8226e8"]]},{"id":"9c74ed5a.a50a1","type":"change","z":"8634e68f.33d288","name":"","rules":[{"t":"set","p":"path","pt":"msg","to":"C:\\Users\\AEAEAE\\Pictures\\DesktopBackground","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":240,"wires":[["5f9837f1.92b958"]]},{"id":"69d0326a.ff4b3c","type":"function","z":"e892f35.0c4c61","name":"inline keyboard message","func":"// node.error(\"Oh no, something bad happened\");\n\ncontext.global.keyboard = { pending : true};\n\n\nlet optionen = msg.optionen;\nlet count;\nlet tasten = \"\";\n    \nif(Array.isArray(optionen)){\n    count = optionen.length;\n    \n    let i;\n    for (i = 0; i < count ; i++) {\n        tasten = tasten + '{\"text\":\"' + optionen[i] + '\",\"callback_data\":\"' + optionen[i] + '\"},';\n    }\n    \n}else{\n    tasten = tasten + '{\"text\":\"' + optionen + '\",\"callback_data\":\"' + optionen + '\"},';\n}\n\n\n// Alles hier unten funktioniert Perfekt\n\ntasten = tasten.slice(0, -1);\n\n\nlet key = '{\"inline_keyboard\": [['+tasten+']]}';\n\nvar opts = {\n    chat_id : msg.payload.chatId,\n    reply_markup: key\n};\n\n\n\nmsg.payload.content = env.get(\"Nachricht\");\nmsg.payload.options = opts;\n\nreturn msg;","outputs":1,"noerr":0,"x":810,"y":240,"wires":[[]]},{"id":"7600fac2.559b24","type":"function","z":"e892f35.0c4c61","name":"separate message","func":"let count;\nlet optionen\n\n// Option wird heir gesetzt\n\nif(env.get(\"OptionDynamic\")){\n    optionen = msg.OptionDynamic;\n}else{\n    optionen = env.get(\"Optionen\").split(\",\");\n}\n\n\n\n// Array vs Ones Nachrichten Spam für mehr Option\nif(env.get(\"SingleOrArraySpam\")){\n    if(Array.isArray(optionen)){\n            count = optionen.length;}else{\n                count = 1;\n            }\n    \n        let i;\n        for (i = 0; i < count; i++) {\n            msg.optionen = optionen[i];\n            node.send(msg);\n        }\n}else{\n    msg.optionen = optionen;\n}\n\n\nreturn ","outputs":1,"noerr":0,"x":490,"y":240,"wires":[["69d0326a.ff4b3c"]]},{"id":"7b714822.8226e8","type":"change","z":"8634e68f.33d288","name":"","rules":[{"t":"set","p":"OptionDynamic","pt":"msg","to":"files","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":990,"y":280,"wires":[["f1e9ea10.69f1e8"]]},{"id":"609e4af4.b07fb4","type":"telegram event","z":"8634e68f.33d288","name":"","bot":"31b2379a.04d2d8","event":"callback_query","autoanswer":false,"x":160,"y":540,"wires":[["3696a7e8.e14198"]]},{"id":"e3057cb.6678f8","type":"telegram sender","z":"8634e68f.33d288","name":"","bot":"31b2379a.04d2d8","x":1230,"y":500,"wires":[[]]},{"id":"7da28243.4c649c","type":"subflow:2473102b.7ad87","z":"8634e68f.33d288","name":"","env":[{"name":"type","value":"photo","type":"str"},{"name":"chatId","value":"-459335104","type":"num"},{"name":"InputContentToggle","value":"false","type":"bool"},{"name":"chateId","value":"-459335104","type":"num"}],"x":1060,"y":500,"wires":[["e3057cb.6678f8"]]},{"id":"33b67c81.156b34","type":"function","z":"8634e68f.33d288","name":"SetDatei","func":"\n\nmsg.customcontent = msg.path +'\\\\'+ msg.payload.content;\nmsg.dateityp = msg.payload.content.slice(-3);\n\nreturn msg;","outputs":1,"noerr":0,"x":720,"y":540,"wires":[["f590a0fb.c644e","feb4fe84.9bc51"]]},{"id":"887cd987.90af58","type":"change","z":"8634e68f.33d288","name":"","rules":[{"t":"set","p":"path","pt":"msg","to":"C:\\Users\\AEAEAE\\Pictures\\DesktopBackground","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":550,"y":540,"wires":[["33b67c81.156b34"]]},{"id":"feb4fe84.9bc51","type":"debug","z":"8634e68f.33d288","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"dateityp","targetType":"msg","x":950,"y":620,"wires":[]},{"id":"c17189f5.7dcb18","type":"telegram command","z":"8634e68f.33d288","name":"","command":"/help","bot":"31b2379a.04d2d8","strict":false,"x":130,"y":160,"wires":[["fac6a77c.b49d38"],[]]},{"id":"2cee8029.6d889","type":"telegram command","z":"57564e10.76e3a","d":true,"name":"","command":"/LOL","bot":"31b2379a.04d2d8","strict":false,"x":230,"y":160,"wires":[["b11cc8d3.7b8eb8"],["de718011.72263"]]},{"id":"380bf888.2e0ae8","type":"telegram sender","z":"57564e10.76e3a","d":true,"name":"","bot":"31b2379a.04d2d8","x":990,"y":140,"wires":[[]]},{"id":"e08109e8.e87568","type":"telegram sender","z":"57564e10.76e3a","d":true,"name":"","bot":"31b2379a.04d2d8","x":990,"y":200,"wires":[[]]},{"id":"b11cc8d3.7b8eb8","type":"subflow:e42fce10.df527","z":"57564e10.76e3a","d":true,"name":"","env":[{"name":"Nachricht","value":"Hallo Welt","type":"str"},{"name":"Optionen","value":"Yes,No,Noo","type":"str"}],"x":490,"y":140,"wires":[["380bf888.2e0ae8"]]},{"id":"67c5686d.493df8","type":"switch","z":"57564e10.76e3a","d":true,"name":"","property":"payload.content","propertyType":"msg","rules":[{"t":"eq","v":"Yes","vt":"str"},{"t":"eq","v":"No","vt":"str"},{"t":"eq","v":"Noo","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":770,"y":200,"wires":[["e08109e8.e87568"],["e08109e8.e87568"],["e08109e8.e87568"]]},{"id":"de718011.72263","type":"subflow:25552ba1.aec3a4","z":"57564e10.76e3a","d":true,"name":"","env":[],"x":540,"y":200,"wires":[["67c5686d.493df8"]]},{"id":"c35a6af6.1a6258","type":"comment","z":"57564e10.76e3a","name":"Beispiel","info":"","x":110,"y":80,"wires":[]},{"id":"d635e0bb.99de6","type":"fs-ops-dir","z":"57564e10.76e3a","d":true,"name":"","path":"path","pathType":"msg","filter":"*","filterType":"str","dir":"files","dirType":"msg","x":460,"y":540,"wires":[["6bbdb70.7cd7048"]]},{"id":"58a55bd2.118324","type":"inject","z":"57564e10.76e3a","d":true,"name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":540,"wires":[["99f4c47.fc98238"]]},{"id":"92f94439.4076c8","type":"telegram sender","z":"57564e10.76e3a","d":true,"name":"","bot":"31b2379a.04d2d8","x":1010,"y":540,"wires":[[]]},{"id":"b8e506e5.ba12f8","type":"subflow:2473102b.7ad87","z":"57564e10.76e3a","d":true,"name":"","env":[{"name":"type","value":"photo","type":"str"},{"name":"chatId","value":"-459335104","type":"num"},{"name":"InputContentToggle","value":"false","type":"bool"},{"name":"chateId","value":"-459335104","type":"num"}],"x":820,"y":540,"wires":[["92f94439.4076c8"]]},{"id":"99f4c47.fc98238","type":"change","z":"57564e10.76e3a","d":true,"name":"","rules":[{"t":"set","p":"path","pt":"msg","to":"C:\\Users\\AEAEAE\\Pictures\\DesktopBackground","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":310,"y":540,"wires":[["d635e0bb.99de6"]]},{"id":"6bbdb70.7cd7048","type":"function","z":"57564e10.76e3a","d":true,"name":"","func":"\n\nmsg.customcontent = msg.path +'\\\\'+ msg.files[2];\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":540,"wires":[["b8e506e5.ba12f8"]]},{"id":"8a0a416e.477ef","type":"switch","z":"fcbed297.e969b","name":"Erlaubnis","property":"payload.chatId","propertyType":"msg","rules":[{"t":"eq","v":"-459335104","vt":"num"},{"t":"eq","v":"259572712","vt":"str"},{"t":"eq","v":"213321950","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":200,"y":80,"wires":[[],[],[]]},{"id":"3696a7e8.e14198","type":"subflow:fcbed297.e969b","z":"8634e68f.33d288","name":"","x":380,"y":540,"wires":[["887cd987.90af58"]]},{"id":"ffd59670.4d0428","type":"subflow:fcbed297.e969b","z":"8634e68f.33d288","name":"","env":[],"x":300,"y":240,"wires":[["9c74ed5a.a50a1"]]},{"id":"bb916677.77c108","type":"telegram command","z":"8634e68f.33d288","name":"","command":"/pdf","bot":"31b2379a.04d2d8","strict":false,"x":130,"y":320,"wires":[["f7c54fab.61748"],[]]},{"id":"f7c54fab.61748","type":"subflow:fcbed297.e969b","z":"8634e68f.33d288","name":"","env":[],"x":300,"y":320,"wires":[["bf87ca02.9ba558"]]},{"id":"496f4c7f.e09f14","type":"fs-ops-dir","z":"8634e68f.33d288","name":"","path":"path","pathType":"msg","filter":".pdf","filterType":"str","dir":"files","dirType":"msg","x":620,"y":320,"wires":[["7b714822.8226e8"]]},{"id":"bf87ca02.9ba558","type":"change","z":"8634e68f.33d288","name":"","rules":[{"t":"set","p":"path","pt":"msg","to":"C:\\Users\\AEAEAE\\Pictures\\DesktopBackground","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":320,"wires":[["496f4c7f.e09f14"]]},{"id":"f590a0fb.c644e","type":"switch","z":"8634e68f.33d288","name":"dateityp","property":"dateityp","propertyType":"msg","rules":[{"t":"eq","v":"jpg","vt":"str"},{"t":"eq","v":"pdf","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":900,"y":540,"wires":[["7da28243.4c649c"],["be3cd101.df535"]]},{"id":"6b906388.556e7c","type":"telegram sender","z":"8634e68f.33d288","name":"","bot":"31b2379a.04d2d8","x":1230,"y":560,"wires":[[]]},{"id":"be3cd101.df535","type":"subflow:2473102b.7ad87","z":"8634e68f.33d288","name":"","env":[{"name":"type","value":"document","type":"str"},{"name":"chatId","value":"-459335104","type":"num"},{"name":"InputContentToggle","value":"false","type":"bool"},{"name":"chateId","value":"-459335104","type":"num"}],"x":1060,"y":560,"wires":[["6b906388.556e7c"]]},{"id":"fac6a77c.b49d38","type":"function","z":"8634e68f.33d288","name":"HilfsText","func":"var helpMessage =\"/help -show help \\r\\n\";\nhelpMessage += \"\\r\\n\";\nhelpMessage += \"/jpg -show all jpg \\r\\n\";\nhelpMessage += \"\\r\\n\";\nhelpMessage += \"/pdf -show all pdf \\r\\n\";\n\nhelpMessage += \"\\r\\n\";\nhelpMessage += \"Hallo \" + msg.originalMessage.from.username + \" solltest du keine Antwort erhalten auf die Befehle gibt den WG-Admin bitte dein ChateId \\r\\n\";\nhelpMessage += \"\\r\\n\";\nhelpMessage += \"Deine Chate ID: \" + msg.payload.chatId;\nhelpMessage += \"\\r\\n\";\n\nmsg.payload.content = helpMessage;\n\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":160,"wires":[["8f83f207.14d41"]]},{"id":"8f83f207.14d41","type":"telegram sender","z":"8634e68f.33d288","name":"","bot":"31b2379a.04d2d8","x":570,"y":160,"wires":[[]]}]